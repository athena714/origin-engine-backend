<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Domain Risk Overview</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <main class="panel">
    <header class="header">
      <div class="brand">
        <span class="eyebrow">Investigative Toolkit</span>
        <h1>Domain Risk</h1>
      </div>
      <span id="riskBadge" class="badge badge-neutral" aria-live="polite">Pending</span>
    </header>

    <section class="intelligence" aria-labelledby="intelligence-title">
      <div class="section-heading">
        <h2 id="intelligence-title">Domain Intelligence</h2>
        <div class="spinner" id="loadingSpinner" role="status" aria-live="polite" aria-label="Loading"></div>
      </div>
      <dl class="fact-grid">
        <div class="fact">
          <dt>Created Date</dt>
          <dd id="createdDate">—</dd>
        </div>
        <div class="fact">
          <dt>Owner</dt>
          <dd id="owner">—</dd>
        </div>
      </dl>
    </section>

    <button id="archiveButton" class="action">Check Archives</button>
  </main>

  <script>
    const riskBadge = document.getElementById('riskBadge');
    const archiveButton = document.getElementById('archiveButton');
    const spinner = document.getElementById('loadingSpinner');

    function setRisk(level) {
      const levels = ['low', 'medium', 'high'];
      riskBadge.className = 'badge ' + (levels.includes(level) ? `badge-${level}` : 'badge-neutral');
      riskBadge.textContent = level === 'low' ? 'Low' : level === 'medium' ? 'Moderate' : level === 'high' ? 'High' : 'Pending';
    }

    function openArchive(tab) {
      if (!tab?.url) return;
      const archiveUrl = `https://archive.today/?run=1&url=${encodeURIComponent(tab.url)}`;
      chrome.tabs.create({ url: archiveUrl });
    }

    archiveButton.addEventListener('click', () => {
      chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => {
        openArchive(tabs[0]);
      });
    });

    // Placeholder initialization; in a real flow these would be populated after analysis.
    spinner.classList.add('visible');
    setTimeout(() => {
      spinner.classList.remove('visible');
      setRisk('medium');
      document.getElementById('createdDate').textContent = '2014-08-17';
      document.getElementById('owner').textContent = 'Example Registrar, LLC';
    }, 800);
  </script>
</body>
</html>
